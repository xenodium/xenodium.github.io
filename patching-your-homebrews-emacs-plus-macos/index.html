<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2025-07-23 Wed 10:49 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Patching your Homebrews Emacs Plus (macOS)</title>
<meta name="author" content="Álvaro Ramírez" />
<meta name="generator" content="Org Mode" />
<style type="text/css">
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
<style type='text/css'>
         /* https://stackoverflow.com/questions/6370690/media-queries-how-to-target-desktop-tablet-and-mobile */

         body {
           font-size: 100%;
           max-width: 88ch;
           padding: 2ch;
           margin: auto;
           background-color: white;
         }

         .figure {
           padding: 0;
         }

         /* Table left border */
         .left {
           border-left: 1px solid #ccc;
         }

         .author {
           font-size: 1em;
           text-align: right;
           color: rgb(51, 51, 51);
           font-weight: bold;
           font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
           line-height: 1.15em;
         }

         .title {
           display: none; /* Title already included in header. Hide. */
           color: rgb(51, 51, 51);
           font-size: 1em;
           text-align: right;
         }

         .org-src-container {
           background-color: #fbfbfb;
           border-radius: 10px;
         }

         #contact-header {
           width: 100%;
         }

         #contact-right {
           text-align: right;
         }

         #contact-left {
           text-align: left;
         }

         #content {
         }

         blockquote {
           overflow: auto;
         }

         b, strong {
          font-weight: bold;
         }

         pre {
           border: none;
           box-shadow: none;
         }

         pre.src {
           overflow: auto;
         }

         /* Hide sh/bash/Emacs Lisp overlay */
         pre.src:hover:before {
           display: none;
         }

         p, .org-ol, .org-ul, .org-left {
           color: #3A4145;
           font-family: 'Lucida Grande', 'Lucida Sans Unicode',
               'Lucida Sans', Geneva, Verdana, sans-serif;
           font-size: 1em;
           font-style: normal;
           font-weight: 300;
           letter-spacing: 0.01rem;
           line-height: 1.5em;
           text-rendering: optimizelegibility;
         }

         h1, h2, h3, h4, h5, #preamble {
           color: #2E2E2E;
           font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
           line-height: 1.15em;
         }

         h1 {
           font-size: 2em;
         }

         h2 {
           font-size: 1.6em;
           letter-spacing: -0.02em;
           margin-bottom: 0px;
           text-indent: -3px;
         }

         h3 {
           font-size: 1.2em;
         }

         #preamble {
           text-align: right;
         }

         .timestamp {
          color: #a9a9a9;
          display: block;
          font-family: 'Lucida Grande', 'Lucida Sans Unicode',
              'Lucida Sans', Geneva, Verdana, sans-serif;
          font-size: 0.5em;
          font-style: normal;
          font-weight: 300;
          line-height: 1em;
         }

         .modified-timestamp {
           color: #D3d3d3;
           font-family: 'Lucida Grande', 'Lucida Sans Unicode',
               'Lucida Sans', Geneva, Verdana, sans-serif;
           font-size: 0.8em;
           text-rendering: optimizelegibility;
         }

         a {
          color: #4183C4;
          text-decoration: none;
         }

         a:visited {
          background-color: #4183C4;
         }

         .outline-2 {
         }

         .example {
           white-space: pre-wrap;
           background-color: #f8ffe1;
         }
       </style>

       <!-- Start of Goat Code -->
       <script data-goatcounter="https://xenodium.goatcounter.com/count"
               async src="//gc.zgo.at/count.js">
       </script>
       <!-- End of Goat Code -->
</head>
<body>
<div id="preamble" class="status">

<table id='contact-header'>
  <tr>
    <td id='contact-left'>
      <a style='color:rgb(51, 51, 51);' href='/'>index</a>
      <a style='color:rgb(51, 51, 51);' href='/rss.xml'>rss</a>
    </td>
    <td id='contact-right'>
      <a rel='me' href='https://indieweb.social/@xenodium'>mastodon</a>
      <a href='https://twitter.com/xenodium'>twitter</a>
      <a href='http://github.com/xenodium'>github</a>
      <a href='http://uk.linkedin.com/in/xenodium'>linkedin</a>
      <a href='mailto:me@xenodium.com'>email</a>
    </td>
  </tr>
  <tr>
    <td style='text-align: left;'>
      <a href='https://plainorg.com'>
        <img style='padding-top: 5px; max-width: 4ch;' src='https://plainorg.com/favicon.ico'/>
      </a>
      <a href='https://apps.apple.com/app/id1671420139'>
        <img style='padding-top: 5px; max-width: 4ch;' src='../images/scratch-a-minimal-scratch-area/scratch_icon.png'/>
      </a>
      <a href='https://flathabits.com'>
        <img style='padding-top: 5px; max-width: 4ch;' src='https://flathabits.com/favicon.ico'/>
      </a>
      <a href='https://apps.apple.com/app/id6480411697'>
        <img style='padding-top: 5px; max-width: 4ch;' src='../images/fresh-eyes-now-on-the-app-store/fresh_eyes_icon.png'/>
      </a>
    </td>
    <td style='padding-top:10px;'>
      <span class='author'>Álvaro Ramírez</span><br/>
      <a style='color:rgb(51, 51, 51);' href='https://github.com/sponsors/xenodium'>sponsor</a>
    </td>
  </tr>
</table>
</div>
<div id="content" class="content">
<h1 class="title">Álvaro Ramírez</h1>
<div id="outline-container-patching-your-homebrews-emacs-plus-macos" class="outline-2">
<h2 id="patching-your-homebrews-emacs-plus-macos"><span class="timestamp-wrapper"><span class="timestamp">23 July 2025</span></span> Patching your Homebrew's Emacs Plus (macOS)</h2>
<div class="outline-text-2" id="text-patching-your-homebrews-emacs-plus-macos">
<p>
Patching and building <a href="https://www.gnu.org/software/emacs/">Emacs</a> from source on macOS is fairly straightforward, but what if I'd like to patch my <a href="https://github.com/d12frosted/homebrew-emacs-plus">Emacs Plus Homebrew</a> builds?
</p>

<p>
Let's cover both ways of patching our favourite editor&#x2026;
</p>
</div>
<div id="outline-container-org0cee55b" class="outline-3">
<h3 id="org0cee55b">Patching Emacs upstream sources</h3>
<div class="outline-text-3" id="text-org0cee55b">
<p>
If you'd like to build from the <a href="https://cgit.git.savannah.gnu.org/cgit/emacs.git/log/">master</a> branch, you can check its sources out like so:
</p>

<div class="org-src-container">
<pre class="src src-sh">git clone git://git.sv.gnu.org/emacs.git
<span style="color: #a71d5d;">cd</span> emacs
</pre>
</div>

<p>
Next, we'll patch Emacs source as needed. For example, I recently <a href="https://debbugs.gnu.org/cgi/bugreport.cgi?bug=79070">wanted to patch src/nsterm.m</a> to see if I could fix a <a href="https://lists.gnu.org/archive/html/bug-gnu-emacs/2025-03/msg00585.html">macOS dictation regression introduced on Emacs 30</a>.
</p>

<div class="org-src-container">
<pre class="src src-diff"><span style="color: #ffffff; background-color: #333333;">diff --git a/src/nsterm.m b/src/nsterm.m</span>
<span style="color: #ffffff; background-color: #333333;">index 003aadb9782..2b34894f36e 100644</span>
<span style="color: #ffffff; background-color: #333333;">--- </span><span style="color: #ffffff; background-color: #333333; font-weight: bold;">a/src/nsterm.m</span>
<span style="color: #ffffff; background-color: #333333;">+++ </span><span style="color: #ffffff; background-color: #333333; font-weight: bold;">b/src/nsterm.m</span>
<span style="color: #ffffff; background-color: #333333;">@@ -7413,7 +7413,24 @@</span><span style="color: #ffffff; background-color: #333333;"> - (NSRange)selectedRange</span>
 {
   if (NS_KEYLOG)
     NSLog (@"selectedRange request");
<span style="color: #333333; background-color: #ffecec;">-</span><span style="color: #333333; background-color: #ffecec;">  return NSMakeRange (</span><span style="color: #333333; background-color: #f8cbcb;">NSNotFound</span><span style="color: #333333; background-color: #ffecec;">, 0);</span>
<span style="color: #333333; background-color: #eaffea;">+</span>
<span style="color: #333333; background-color: #a6f3a6;">+</span><span style="color: #333333; background-color: #eaffea;">  </span><span style="color: #333333; background-color: #a6f3a6;">struct window *w = XWINDOW (FRAME_SELECTED_WINDOW (emacsframe));</span><span style="color: #333333; background-color: #a6f3a6;">
</span><span style="color: #333333; background-color: #a6f3a6;">+</span><span style="color: #333333; background-color: #a6f3a6;">  struct buffer *buf = XBUFFER (w-&gt;contents);</span><span style="color: #333333; background-color: #a6f3a6;">
</span><span style="color: #333333; background-color: #a6f3a6;">+</span><span style="color: #333333; background-color: #a6f3a6;">  ptrdiff_t point = BUF_PT (buf);</span><span style="color: #333333; background-color: #a6f3a6;">
</span><span style="color: #333333; background-color: #a6f3a6;">+</span><span style="color: #333333; background-color: #a6f3a6;">
</span><span style="color: #333333; background-color: #a6f3a6;">+</span><span style="color: #333333; background-color: #a6f3a6;">  if (NILP (BVAR (buf, mark_active)))</span><span style="color: #333333; background-color: #a6f3a6;">
</span><span style="color: #333333; background-color: #a6f3a6;">+</span><span style="color: #333333; background-color: #a6f3a6;">    {</span><span style="color: #333333; background-color: #a6f3a6;">
</span><span style="color: #333333; background-color: #a6f3a6;">+</span><span style="color: #333333; background-color: #a6f3a6;">      NSUInteger selection_location = point - BUF_BEGV (buf);</span><span style="color: #333333; background-color: #a6f3a6;">
</span><span style="color: #333333; background-color: #a6f3a6;">+</span><span style="color: #333333; background-color: #eaffea;">      return NSMakeRange (</span><span style="color: #333333; background-color: #a6f3a6;">selection_location</span><span style="color: #333333; background-color: #eaffea;">, 0</span><span style="color: #333333; background-color: #a6f3a6;">);</span><span style="color: #333333; background-color: #a6f3a6;">
</span><span style="color: #333333; background-color: #a6f3a6;">+</span><span style="color: #333333; background-color: #a6f3a6;">    }</span><span style="color: #333333; background-color: #a6f3a6;">
</span><span style="color: #333333; background-color: #a6f3a6;">+</span><span style="color: #333333; background-color: #a6f3a6;">
</span><span style="color: #333333; background-color: #a6f3a6;">+</span><span style="color: #333333; background-color: #a6f3a6;">  ptrdiff_t mark = marker_position (BVAR (buf, mark));</span><span style="color: #333333; background-color: #a6f3a6;">
</span><span style="color: #333333; background-color: #a6f3a6;">+</span><span style="color: #333333; background-color: #a6f3a6;">  ptrdiff_t region_start = min (point, mark);</span><span style="color: #333333; background-color: #a6f3a6;">
</span><span style="color: #333333; background-color: #a6f3a6;">+</span><span style="color: #333333; background-color: #a6f3a6;">  ptrdiff_t region_end = max (point, mark);</span><span style="color: #333333; background-color: #a6f3a6;">
</span><span style="color: #333333; background-color: #a6f3a6;">+</span><span style="color: #333333; background-color: #a6f3a6;">  NSUInteger selection_location = region_start - BUF_BEGV (buf);</span><span style="color: #333333; background-color: #a6f3a6;">
</span><span style="color: #333333; background-color: #a6f3a6;">+</span><span style="color: #333333; background-color: #a6f3a6;">  NSUInteger selection_length = region_end - region_start;</span><span style="color: #333333; background-color: #a6f3a6;">
</span><span style="color: #333333; background-color: #a6f3a6;">+</span><span style="color: #333333; background-color: #a6f3a6;">
</span><span style="color: #333333; background-color: #a6f3a6;">+</span><span style="color: #333333; background-color: #a6f3a6;">  return NSMakeRange (selection_location, selection_length</span><span style="color: #333333; background-color: #eaffea;">);</span>
 }

 #if defined (NS_IMPL_COCOA) || GNUSTEP_GUI_MAJOR_VERSION &gt; 0 || \

</pre>
</div>

<p>
Now we're ready to configure and build.
</p>

<div class="org-src-container">
<pre class="src src-sh">./autogen.sh
./configure --with-ns --prefix=<span style="color: #183691;">"$PWD/nextstep/Emacs.app/Contents/MacOS"</span> --enable-locallisppath=<span style="color: #183691;">"${PWD}/nextstep/Emacs.app/Contents/MacOS"</span>
make install
</pre>
</div>

<p>
We've used <code>nextstep/Emacs.app/Contents/MacOS</code> as our target directory, so we can test our builds from exactly there&#x2026; and there you have it, your newly built <code>Emacs.app</code>, ready for opening.
</p>

<div class="org-src-container">
<pre class="src src-sh">open nextstep/Emacs.app
</pre>
</div>
</div>
</div>
<div id="outline-container-org60dceec" class="outline-3">
<h3 id="org60dceec">Patching Emacs Plus</h3>
<div class="outline-text-3" id="text-org60dceec">
<p>
While patching and building upstream Emacs sources as above is fairly common, patching <a href="https://github.com/d12frosted/homebrew-emacs-plus">Emacs Plus</a> may not be as well known.
</p>

<p>
I'm a big fan of <a href="https://d12frosted.io/">Boris Buliga</a>'s excellent <a href="https://brew.sh/">Homebrew</a> recipe and use it daily, so it makes sense for me to get acquainted with its patching capabilities.
</p>

<p>
First we check out the Emacs Plus Homebrew repo:
</p>

<div class="org-src-container">
<pre class="src src-sh">git clone https://github.com/d12frosted/homebrew-emacs-plus.git
<span style="color: #a71d5d;">cd</span> homebrew-emacs-plus
</pre>
</div>

<p>
At this point, it's worth noting Emacs Plus enables building different Emacs versions (29, 30, and even master). It extends Emacs by applying its own patches at build time. For example, if we'd like to patch Emacs 30, we'll customise the 30 build to apply our own changes.
</p>

<p>
Remember our <code>src/nsterm.m</code> patch above? We'll rebased it <a href="https://mirror.lyrahosting.com/gnu/emacs/emacs-30.1.tar.gz">against the Emacs 30 tarball</a> and save in the Emacs Plus patches directory:
</p>

<div class="org-src-container">
<pre class="src src-sh">./patches/emacs-30/dictation.patch
</pre>
</div>

<p>
Next we'll need to generate a hash to complete our Emacs 30 patch details:
</p>

<div class="org-src-container">
<pre class="src src-bash">sha256sum ./patches/emacs-30/dictation.patch
</pre>
</div>

<pre class="example">
cb102525bba7385d7d85c52d31101af3d2cbbf076468dacbf505039082ec521c  ./patches/emacs-30/dictation.patch
</pre>


<p>
Now we add our patch details to <code>./Formula/emacs-plus@30.rb</code>:
</p>

<div class="org-src-container">
<pre class="src src-ruby">local_patch <span style="color: #183691;">"dictation"</span>, <span style="color: #0086b3;">sha:</span> <span style="color: #183691;">"cb102525bba7385d7d85c52d31101af3d2cbbf076468dacbf505039082ec521c"</span>
</pre>
</div>

<p>
With that, we're ready to build Emacs Plus, which comes with a handy build script. I'm a fan of <a href="https://github.com/SavchenkoValeriy/emacs-icons">Valeriy Savchenko's macOS icons</a>, so I'll throw in the optional icon flag. I should also mention Emacs Plus offers a <a href="https://github.com/d12frosted/homebrew-emacs-plus?tab=readme-ov-file#icons">rich catalog of app icons</a>. Now back to building&#x2026;
</p>

<div class="org-src-container">
<pre class="src src-sh">./build 30 --with-savchenkovaleriy-big-sur-curvy-3d-icon
</pre>
</div>

<p>
The build output should look a little something like the following (look out for our applied patch)
</p>

<div class="org-src-container">
<pre class="src src-sh">./Formula/emacs-plus-local.rb --with-savchenkovaleriy-big-sur-curvy-3d-icon
==&gt; Fetching downloads for: emacs-plus-local
==&gt; Fetching emacs-plus-local
==&gt; Downloading https://ftp.gnu.org/gnu/emacs/emacs-30.1.tar.xz
Already downloaded: /Users/alvaro/Library/Caches/Homebrew/downloads/b2b29daf5d872710063495e32b8b5234c2fbfffccec82222b65e7f2b4e7fb4da--emacs-30.1.tar.xz
==&gt; Patching
==&gt; Applying fix-window-role.patch
==&gt; Applying system-appearance.patch
==&gt; Applying round-undecorated-frame.patch
==&gt; Applying dictation.patch     &lt;---- Our patch &#127881;
==&gt; ./autogen.sh
==&gt; ./configure --disable-silent-rules --enable-locallisppath=/opt/homebrew/share/emacs/site-lisp --infodir=/opt/homebrew/Cellar/emacs-plus-local/30.1/share/info/emacs --with-native-compilation=aot --with-xml2 --
==&gt; gmake
==&gt; gmake install
==&gt; Injecting PATH value to Emacs.app/Contents/Info.plist
Patching plist at /opt/homebrew/Cellar/emacs-plus-local/30.1/Emacs.app/Contents/Info.plist with following PATH value:


...


==&gt; Caveats
Emacs.app was installed to:
  /opt/homebrew/opt/emacs-plus-local

To link the application to default Homebrew App location:
  osascript -e <span style="color: #183691;">'tell application "Finder" to make alias file to posix file "/opt/homebrew/opt/emacs-plus-local/Emacs.app" at posix file "/Applications" with properties {name:"Emacs.app"}'</span>

Your PATH value was injected into Emacs.app/Contents/Info.plist

Report any issues to https://github.com/d12frosted/homebrew-emacs-plus

To start emacs-plus-local now and restart at login:
  brew services start emacs-plus-local
Or, if you don<span style="color: #183691;">'t want/need a background service you can just run:</span>
<span style="color: #183691;">  /opt/homebrew/opt/emacs-plus-local/bin/emacs --fg-daemon</span>
<span style="color: #183691;">==&gt; Summary</span>
<span style="color: #183691;">&#127866;  /opt/homebrew/Cellar/emacs-plus-local/30.1: 7,470 files, 585.0MB, built in 8 minutes 59 seconds</span>
<span style="color: #183691;">==&gt; Running `brew cleanup emacs-plus-local`...</span>
<span style="color: #183691;">Disable this behaviour by setting HOMEBREW_NO_INSTALL_CLEANUP.</span>
<span style="color: #183691;">Hide these hints with HOMEBREW_NO_ENV_HINTS (see `man brew`).</span>
<span style="color: #183691;">alvaro@MacBookPro homebrew-emacs-plus %  osascript -e '</span>tell application <span style="color: #183691;">"Finder"</span> to make alias file to posix file <span style="color: #183691;">"/opt/homebrew/opt/emacs-plus-local/Emacs.app"</span> at posix file <span style="color: #183691;">"/Applications"</span> with properties {name:<span style="color: #183691;">"Emacs.app"</span>}<span style="color: #183691;">'</span>

<span style="color: #183691;">alias file Emacs.app of folder Applications of startup disk</span>
</pre>
</div>

<p>
At this point, your brand new patched Emacs Plus is ready for opening:
</p>

<div class="org-src-container">
<pre class="src src-sh">open /opt/homebrew/opt/emacs-plus-local/Emacs.app
</pre>
</div>

<p>
Notice how <code>Emacs.app</code> is saved under emacs-plus-<code>local</code>, which is different from the default location: emacs-plus. In other words, your patched and regular builds can coexist.
</p>

<p>
I've pushed the changes to my <a href="https://github.com/xenodium/homebrew-emacs-plus">Emacs Plus fork</a>. If keen to take a closer look, check out the <a href="https://github.com/xenodium/homebrew-emacs-plus/commit/2823118f934162bf8757e03bd884e5abd9c25c56">git commit</a>. Should this change be sent to Emacs Plus in a pull request? Maybe not just yet. We'll <a href="https://debbugs.gnu.org/cgi/bugreport.cgi?bug=79070">try to get it admitted upstream first</a>.
</p>

<p>
Now you know at least two ways of building and patching Emacs on macOS. There are more, but these are my favourite two.
</p>
</div>
</div>
<div id="outline-container-org5854667" class="outline-3">
<h3 id="org5854667">Make it all sustainable</h3>
<div class="outline-text-3" id="text-org5854667">
<p>
Learned something new? Enjoying this <a href="https://xenodium.com/">blog</a> or <a href="https://github.com/xenodium">my projects</a>? Help make it <a href="https://github.com/sponsors/xenodium">sustainable</a>.
</p>

<p>
Need a blog? <a href="https://github.com/sponsors/xenodium">I can help with that</a>. Maybe buy my <a href="https://apps.apple.com/us/developer/xenodium-ltd/id304568690">iOS apps</a> too ;)
</p>
</div>
</div>
</div>
</div>
</body>
</html>
